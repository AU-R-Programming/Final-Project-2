<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Final-Project-2: Classification Package Vignette • Classification</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.7.1/jquery.min.js" integrity="sha512-v2CJ7UaYy4JwqLDIrZUI/4hqeoQieOmAZNXBeQyjo21dadnwR+8ZaIJVT8EE2iyI61OV8e6M8PP2/4hpQINQ/g==" crossorigin="anonymous" referrerpolicy="no-referrer"></script><!-- Bootstrap --><link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.4.0/flatly/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Final-Project-2: Classification Package Vignette">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">


    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">Classification</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">0.0.0.9000</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../articles/classification_vignette.html">Overview</a>
</li>
<li>
  <a href="../articles/classification_help.html">Help</a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/AU-R-Programming/Final-Project-2" class="external-link">
    <span class="fa fa-github"></span>

  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->



      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Final-Project-2: Classification Package
Vignette</h1>
                        <h4 data-toc-skip class="author">Shahab Musavi,
John Grace, Nabin Neupane</h4>
            
            <h4 data-toc-skip class="date">2024-12-06</h4>
      

      <div class="hidden name"><code>classification_vignette.Rmd</code></div>

    </div>

    
    
<div class="section level2">
<h2 id="introduction">Introduction<a class="anchor" aria-label="anchor" href="#introduction"></a>
</h2>
<p>The classification package provides tools for logistic regression
using numerical optimization, computing bootstrap confidence intervals
for model coefficients, and evaluating model performance metrics. This
vignette demonstrates these functionalities using the adult dataset.</p>
</div>
<div class="section level2">
<h2 id="preprocessing-the-data">Preprocessing the Data<a class="anchor" aria-label="anchor" href="#preprocessing-the-data"></a>
</h2>
<div class="section level3">
<h3 id="dataset-overview">Dataset Overview<a class="anchor" aria-label="anchor" href="#dataset-overview"></a>
</h3>
<p>First, let let us take a look at the first few rows of the adult data
set. The age values are re-scaled using the max-min method to make them
fall into the range of [0,1] to match other binary values.</p>
<ul>
<li>
<strong>1</strong> indicates income &gt; 50K</li>
<li>
<strong>0</strong> indicates income ≤ 50K</li>
</ul>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Load the dataset</span></span>
<span><span class="va">adult</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/utils/read.table.html" class="external-link">read.csv</a></span><span class="op">(</span><span class="st">"adult.csv"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">adult</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">##         age         workclass  education      marital.status         occupation</span></span>
<span><span class="co">## 1 0.3013699         State-gov  Bachelors       Never-married       Adm-clerical</span></span>
<span><span class="co">## 2 0.4520548  Self-emp-not-inc  Bachelors  Married-civ-spouse    Exec-managerial</span></span>
<span><span class="co">## 3 0.2876712           Private    HS-grad            Divorced  Handlers-cleaners</span></span>
<span><span class="co">## 4 0.4931507           Private       11th  Married-civ-spouse  Handlers-cleaners</span></span>
<span><span class="co">## 5 0.1506849           Private  Bachelors  Married-civ-spouse     Prof-specialty</span></span>
<span><span class="co">## 6 0.2739726           Private    Masters  Married-civ-spouse    Exec-managerial</span></span>
<span><span class="co">##   native.country income</span></span>
<span><span class="co">## 1  United-States      0</span></span>
<span><span class="co">## 2  United-States      0</span></span>
<span><span class="co">## 3  United-States      0</span></span>
<span><span class="co">## 4  United-States      0</span></span>
<span><span class="co">## 5           Cuba      0</span></span>
<span><span class="co">## 6  United-States      0</span></span></code></pre>
</div>
<div class="section level3">
<h3 id="feature-selection-and-transformation">Feature Selection and Transformation<a class="anchor" aria-label="anchor" href="#feature-selection-and-transformation"></a>
</h3>
<p>The adult dataset contains categorical variables, so we first
preprocess it to convert categorical data into numerical values. Also,
to reduce the run time, we just consider <em>age</em> and
<em>education</em> as the predictors.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Select the 'age' and 'education' columns as features and 'income' as the outcome</span></span>
<span><span class="va">features</span> <span class="op">&lt;-</span> <span class="va">adult</span><span class="op">[</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"age"</span>, <span class="st">"education"</span><span class="op">)</span><span class="op">]</span></span>
<span><span class="va">outcome</span> <span class="op">&lt;-</span> <span class="va">adult</span><span class="op">$</span><span class="va">income</span>  <span class="co"># Assuming 'income' is the binary response variable</span></span>
<span></span>
<span><span class="co"># One-hot encode the 'education' column (categorical variable)</span></span>
<span><span class="va">education_transformed</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/model.matrix.html" class="external-link">model.matrix</a></span><span class="op">(</span><span class="op">~</span> <span class="va">education</span> <span class="op">-</span> <span class="fl">1</span>, data <span class="op">=</span> <span class="va">features</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Combine the 'age' column with the one-hot encoded 'education' columns</span></span>
<span><span class="va">X</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">cbind</a></span><span class="op">(</span><span class="fl">1</span>, <span class="va">features</span><span class="op">$</span><span class="va">age</span>, <span class="va">education_transformed</span><span class="op">)</span>  <span class="co"># Add an intercept column</span></span>
<span></span>
<span><span class="co"># Prepare y (response variable)</span></span>
<span><span class="va">y</span> <span class="op">&lt;-</span> <span class="va">outcome</span>  <span class="co"># Keep the outcome variable as-is</span></span>
<span></span>
<span><span class="co"># Check dimensions</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/dim.html" class="external-link">dim</a></span><span class="op">(</span><span class="va">X</span><span class="op">)</span>  <span class="co"># Verify rows (observations) and columns (intercept + predictors)</span></span></code></pre></div>
<pre><code><span><span class="co">## [1] 30162    18</span></span></code></pre>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">y</span><span class="op">)</span>  <span class="co"># Verify length matches rows in X</span></span></code></pre></div>
<pre><code><span><span class="co">## [1] 30162</span></span></code></pre>
</div>
</div>
<div class="section level2">
<h2 id="logistic-regression">Logistic Regression<a class="anchor" aria-label="anchor" href="#logistic-regression"></a>
</h2>
<p>We fit a logistic regression model using the
<code><a href="../reference/logistic_regression.html">logistic_regression()</a></code> function. Here, we only consider the
first 1000 rows of X and y to reduce the run time.</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Subset the first 1000 rows of X and y</span></span>
<span><span class="va">X_subset</span> <span class="op">&lt;-</span> <span class="va">X</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">1000</span>, <span class="op">]</span></span>
<span><span class="va">y_subset</span> <span class="op">&lt;-</span> <span class="va">y</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">1000</span><span class="op">]</span></span>
<span></span>
<span><span class="co"># Fit logistic regression on the subset</span></span>
<span><span class="va">beta</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/logistic_regression.html">logistic_regression</a></span><span class="op">(</span><span class="va">X_subset</span>, <span class="va">y_subset</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">beta</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">##                               [,1]</span></span>
<span><span class="co">##                        -4.21435208</span></span>
<span><span class="co">##                         3.65129144</span></span>
<span><span class="co">## education 10th          0.06355911</span></span>
<span><span class="co">## education 11th         -0.60733910</span></span>
<span><span class="co">## education 12th          2.21342708</span></span>
<span><span class="co">## education 1st-4th      -7.31513623</span></span>
<span><span class="co">## education 5th-6th      -7.72734429</span></span>
<span><span class="co">## education 7th-8th       1.33810143</span></span>
<span><span class="co">## education 9th          -8.38178940</span></span>
<span><span class="co">## education Assoc-acdm    1.80861147</span></span>
<span><span class="co">## education Assoc-voc     2.17981348</span></span>
<span><span class="co">## education Bachelors     2.91574853</span></span>
<span><span class="co">## education Doctorate     4.82902662</span></span>
<span><span class="co">## education HS-grad       1.35284374</span></span>
<span><span class="co">## education Masters       2.75373964</span></span>
<span><span class="co">## education Preschool    -6.65729790</span></span>
<span><span class="co">## education Prof-school   5.48738381</span></span>
<span><span class="co">## education Some-college  1.53229987</span></span></code></pre>
</div>
<div class="section level2">
<h2 id="bootstrap-confidence-intervals">Bootstrap Confidence Intervals<a class="anchor" aria-label="anchor" href="#bootstrap-confidence-intervals"></a>
</h2>
<p>We compute 95% confidence intervals for the coefficients using the
<code><a href="../reference/bootstrap_ci.html">bootstrap_ci()</a></code> function.</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">ci</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/bootstrap_ci.html">bootstrap_ci</a></span><span class="op">(</span><span class="va">X_subset</span>, <span class="va">y_subset</span>, n_boot <span class="op">=</span> <span class="fl">50</span>, alpha <span class="op">=</span> <span class="fl">0.05</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">ci</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">##                              lower     upper</span></span>
<span><span class="co">##                         -7.1688575 -3.283190</span></span>
<span><span class="co">##                          2.6278736  4.402077</span></span>
<span><span class="co">## education 10th         -13.4496076  2.489430</span></span>
<span><span class="co">## education 11th         -15.8560389  1.237770</span></span>
<span><span class="co">## education 12th          -4.4397902  5.361805</span></span>
<span><span class="co">## education 1st-4th      -13.9358394 -3.888184</span></span>
<span><span class="co">## education 5th-6th      -12.2542622 -5.401806</span></span>
<span><span class="co">## education 7th-8th       -8.3262360  4.486047</span></span>
<span><span class="co">## education 9th          -13.3449468 -6.117221</span></span>
<span><span class="co">## education Assoc-acdm     0.6404232  4.478235</span></span>
<span><span class="co">## education Assoc-voc      0.8342246  5.385886</span></span>
<span><span class="co">## education Bachelors      1.6710875  5.663695</span></span>
<span><span class="co">## education Doctorate      4.3583664 18.055563</span></span>
<span><span class="co">## education HS-grad        0.3139782  4.231594</span></span>
<span><span class="co">## education Masters        1.4849686  5.317627</span></span>
<span><span class="co">## education Preschool    -10.5376538  0.000000</span></span>
<span><span class="co">## education Prof-school    4.3441012 20.143674</span></span>
<span><span class="co">## education Some-college   0.8005300  4.183143</span></span></code></pre>
</div>
<div class="section level2">
<h2 id="model-evaluation">Model Evaluation<a class="anchor" aria-label="anchor" href="#model-evaluation"></a>
</h2>
<p>We evaluate the performance of the logistic regression model using
the <code><a href="../reference/evaluate_model.html">evaluate_model()</a></code> function.</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Predicted probabilities</span></span>
<span><span class="va">y_pred</span> <span class="op">&lt;-</span> <span class="fl">1</span> <span class="op">/</span> <span class="op">(</span><span class="fl">1</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">exp</a></span><span class="op">(</span><span class="op">-</span><span class="va">X</span> <span class="op"><a href="https://rdrr.io/r/base/matmult.html" class="external-link">%*%</a></span> <span class="va">beta</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Evaluate model</span></span>
<span><span class="va">metrics</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/evaluate_model.html">evaluate_model</a></span><span class="op">(</span><span class="va">y</span>, <span class="va">y_pred</span>, cutoff <span class="op">=</span> <span class="fl">0.5</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">metrics</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## $ConfusionMatrix</span></span>
<span><span class="co">##           True</span></span>
<span><span class="co">## Predicted  Positive Negative</span></span>
<span><span class="co">##   Positive     2123     1421</span></span>
<span><span class="co">##   Negative     5385    21233</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## $Prevalence</span></span>
<span><span class="co">## [1] 0.2489225</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## $Accuracy</span></span>
<span><span class="co">## [1] 0.7743518</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## $Sensitivity</span></span>
<span><span class="co">## [1] 0.2827651</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## $Specificity</span></span>
<span><span class="co">## [1] 0.9372738</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## $FDR</span></span>
<span><span class="co">## [1] 0.4009594</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## $DOR</span></span>
<span><span class="co">## [1] 5.890899</span></span></code></pre>
</div>
<div class="section level2">
<h2 id="summary">Summary<a class="anchor" aria-label="anchor" href="#summary"></a>
</h2>
<p>This vignette demonstrated:</p>
<ul>
<li>Preprocessing: Data preparation and transformation.</li>
<li>Modeling: Logistic regression for binary classification.</li>
<li>Inference: Bootstrap confidence intervals for coefficients.</li>
<li>Evaluation: Metrics to assess model performance.</li>
</ul>
<p>Find more information here: <a href="https://au-r-programming.github.io/Final-Project-2/" class="external-link uri">https://au-r-programming.github.io/Final-Project-2/</a></p>
</div>
<div class="section level2">
<h2 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a>
</h2>
<p>1- <a href="https://medium.com/@curryrowan/simplified-logistic-regression-classification-with-categorical-variables-in-python-1ce50c4b137" class="external-link uri">https://medium.com/@curryrowan/simplified-logistic-regression-classification-with-categorical-variables-in-python-1ce50c4b137</a></p>
<p>2- <a href="https://smac-group.github.io/irg/articles/vignette.html" class="external-link uri">https://smac-group.github.io/irg/articles/vignette.html</a></p>
<p>3- <a href="https://stackoverflow.com/questions/72179150/error-in-read-dcf-line-starting-is-malformed" class="external-link uri">https://stackoverflow.com/questions/72179150/error-in-read-dcf-line-starting-is-malformed</a></p>
<p>4- <a href="https://chatgpt.com/share/67532e2d-2d1c-8011-b0a6-0c85340e9182" class="external-link uri">https://chatgpt.com/share/67532e2d-2d1c-8011-b0a6-0c85340e9182</a></p>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

      </div>

</div>



      <footer><div class="copyright">
  <p></p>
<p>Developed by John Grace, Nabin Neupane, Shahib Musavi.</p>
</div>

<div class="pkgdown">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.9000.</p>
</div>

      </footer>
</div>






  </body>
</html>
